#!/bin/sh

die() {
	echo $1
	exit 1
}

if [ -z "$KK_UPSTAIRS" ]; then
	n=`/bin/ls Kookbook.* 2>/dev/null | wc -l`
	[ $n -eq 0 ] && die "No kookbook found."
	[ $n -gt 1 ] && die "Kookbook.*: Too many kookbooks found."
else
	cwd=`pwd`
	while [ true ]; do
		n=`/bin/ls Kookbook.* 2>/dev/null | wc -l`
		[ $n -eq 1 ] && break
		[ $n -gt 1 ] && die "Kookbook.*: Too many kookbooks found."
		old=$cwd
		cd ..
		cwd=`pwd`
		[ "$cwd" == "$old" ] && die "No kookbook found."
	done
fi

kookbook=`/bin/ls Kookbook.*`
case $kookbook in
*.py)	pykook $@
	;;
*.pl)	plkook $@
	;;
#*.php)	phpkook $@
#	;;
#*.js)	jskook $@
#	;;
*.yaml)	kook $@
	;;
esac
